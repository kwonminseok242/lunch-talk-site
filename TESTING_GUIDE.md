# 🧪 테스트 가이드

이 문서는 현직자 런치톡 질문 수집 웹사이트의 테스트 방법을 설명합니다.

## 📋 목차

- [로컬 테스트](#-로컬-테스트)
- [데이터 저장 테스트](#-데이터-저장-테스트)
- [재시작 후 데이터 유지 테스트](#-재시작-후-데이터-유지-테스트)
- [기능별 테스트 체크리스트](#-기능별-테스트-체크리스트)
- [Streamlit Cloud 배포 전 테스트](#-streamlit-cloud-배포-전-테스트)

---

## 🖥️ 로컬 테스트

### 1. 기본 실행 테스트

```bash
# 프로젝트 폴더로 이동
cd lunch-talk-questions

# 의존성 설치
pip install -r requirements.txt

# 앱 실행
streamlit run app.py
```

**확인사항**:
- ✅ 브라우저에서 `http://localhost:8501` 접속 가능
- ✅ 타이틀과 KPI가 정상 표시됨
- ✅ 질문 작성 폼이 보임
- ✅ 사이드바 필터가 정상 작동

---

## 💾 데이터 저장 테스트

### 테스트 1: 질문 등록 및 확인

1. **질문 등록**
   - 왼쪽 폼에서 질문 작성
   - "✅ 질문 등록하기" 클릭
   - 성공 메시지 확인

2. **질문 확인**
   - 오른쪽 목록에서 등록한 질문이 보이는지 확인
   - 질문 내용, 작성자, 시간이 정상 표시되는지 확인

3. **데이터 저장 확인**
   - "ℹ️ 데이터 저장 정보" Expander 클릭
   - 현재 저장 방식 확인 (SQLite 또는 Google Sheets)
   - 저장된 질문 수 확인

### 테스트 2: SQLite 데이터베이스 확인

```bash
# 프로젝트 폴더에서
ls -lh questions.db

# SQLite 데이터베이스 내용 확인 (선택사항)
sqlite3 questions.db
```

SQLite 콘솔에서:
```sql
-- 테이블 구조 확인
.schema questions

-- 데이터 확인
SELECT * FROM questions;

-- 종료
.quit
```

**확인사항**:
- ✅ `questions.db` 파일이 생성됨
- ✅ 질문 데이터가 테이블에 저장됨
- ✅ ID, 이름, 질문, 시간, 좋아요가 모두 저장됨

### 테스트 3: 관리자 페이지에서 확인

1. 사이드바에서 "🔐 관리자" Expander 클릭
2. "관리자 페이지 접속" 버튼 클릭
3. 비밀번호 입력: `woori2024`
4. "📋 질문 관리" 탭에서 등록한 질문 확인

**확인사항**:
- ✅ 관리자 페이지에서 질문이 보임
- ✅ 질문 내용이 정확히 표시됨
- ✅ 작성자, 시간, 좋아요가 정상 표시됨

---

## 🔄 재시작 후 데이터 유지 테스트

### 테스트 4: 앱 재시작 후 데이터 확인

1. **질문 등록**
   - 여러 개의 질문 등록 (3~5개)
   - 각 질문에 좋아요 추가

2. **앱 재시작**
   ```bash
   # 터미널에서 Ctrl+C로 앱 중지
   # 다시 실행
   streamlit run app.py
   ```

3. **데이터 확인**
   - 등록한 질문들이 모두 보이는지 확인
   - 좋아요 수가 유지되는지 확인
   - 관리자 페이지에서도 확인

**확인사항**:
- ✅ 재시작 후에도 모든 질문이 보임
- ✅ 좋아요 수가 유지됨
- ✅ SQLite 데이터베이스 파일이 존재함

### 테스트 5: SQLite 파일 삭제 후 복구 테스트

```bash
# 데이터베이스 파일 백업
cp questions.db questions.db.backup

# 데이터베이스 파일 삭제
rm questions.db

# 앱 재시작
streamlit run app.py
```

**확인사항**:
- ✅ 새로운 빈 데이터베이스가 생성됨
- ✅ 질문이 없음 (정상)

```bash
# 백업 복구
cp questions.db.backup questions.db

# 앱 재시작
streamlit run app.py
```

**확인사항**:
- ✅ 백업한 질문들이 다시 보임

---

## ✅ 기능별 테스트 체크리스트

### 질문 작성 기능

- [ ] 익명으로 질문 등록 (체크박스 해제)
- [ ] 이름 표시하고 질문 등록 (체크박스 체크)
- [ ] 1000자 제한 확인 (900자 경고 표시)
- [ ] 빈 질문 등록 시도 (에러 메시지 확인)
- [ ] 폼 제출 후 자동 초기화 확인

### 검색 및 정렬 기능

- [ ] 키워드로 질문 검색
- [ ] 검색 결과가 정확히 필터링되는지 확인
- [ ] 검색 초기화 버튼 작동 확인
- [ ] 좋아요 순 정렬 확인
- [ ] 최신순 정렬 확인
- [ ] 작성자순 정렬 확인

### 좋아요 기능

- [ ] 질문에 좋아요 추가
- [ ] 좋아요 수 증가 확인
- [ ] 같은 질문에 다시 좋아요 시도 (비활성화 확인)
- [ ] 좋아요 완료 상태 유지 확인

### 관리자 페이지

- [ ] 관리자 로그인 (비밀번호: `woori2024`)
- [ ] 질문 목록 확인
- [ ] 질문 검색 및 필터링
- [ ] 질문 삭제 (2단계 확인)
- [ ] 통계 확인 (총 질문 수, 좋아요 수 등)
- [ ] CSV 내보내기
- [ ] Excel 내보내기
- [ ] 로그아웃 기능

### 데이터 저장 상태

- [ ] "ℹ️ 데이터 저장 정보"에서 저장 방식 확인
- [ ] SQLite 사용 시 "영구 저장" 메시지 확인
- [ ] JSON 사용 시 경고 메시지 확인
- [ ] 저장된 질문 수 확인

---

## ☁️ Streamlit Cloud 배포 전 테스트

### 테스트 6: 로컬에서 모든 기능 테스트

위의 모든 체크리스트를 완료한 후 배포합니다.

### 테스트 7: GitHub에 푸시 후 확인

```bash
# 변경사항 커밋
git add .
git commit -m "Add SQLite for persistent storage"

# GitHub에 푸시
git push origin main
```

**확인사항**:
- ✅ GitHub에 모든 파일이 업로드됨
- ✅ `questions.db`는 `.gitignore`에 있어 업로드되지 않음 (정상)
- ✅ `questions.json`도 `.gitignore`에 있어 업로드되지 않음 (정상)

### 테스트 8: Streamlit Cloud 배포 후 테스트

1. **배포 확인**
   - Streamlit Cloud에서 앱이 정상 실행되는지 확인
   - 에러가 없는지 확인

2. **데이터 저장 테스트**
   - 질문 등록
   - "ℹ️ 데이터 저장 정보"에서 SQLite 사용 확인
   - 앱 재시작 (Streamlit Cloud에서 "Reboot app")
   - 재시작 후 질문이 유지되는지 확인

3. **Google Sheets 연동 테스트** (선택사항)
   - Secrets에 Google Sheets 설정 추가
   - 앱 재시작
   - "ℹ️ 데이터 저장 정보"에서 Google Sheets 사용 확인
   - Google Sheets에서 직접 데이터 확인

---

## 🐛 문제 발생 시 확인사항

### 질문이 저장되지 않음

1. **파일 권한 확인**
   ```bash
   ls -la questions.db
   ```

2. **에러 메시지 확인**
   - 앱 실행 시 터미널에 에러가 있는지 확인
   - "ℹ️ 데이터 저장 정보"에서 에러 메시지 확인

3. **데이터베이스 파일 확인**
   ```bash
   sqlite3 questions.db "SELECT COUNT(*) FROM questions;"
   ```

### 관리자 페이지에서 질문이 보이지 않음

1. **파일 경로 확인**
   - `app.py`와 `pages/admin.py`가 같은 경로를 참조하는지 확인
   - 두 파일 모두 `Path(__file__).parent` 사용 확인

2. **데이터베이스 확인**
   ```bash
   sqlite3 questions.db "SELECT * FROM questions;"
   ```

### 재시작 후 데이터가 사라짐

1. **저장 방식 확인**
   - "ℹ️ 데이터 저장 정보"에서 현재 저장 방식 확인
   - SQLite 또는 Google Sheets를 사용하는지 확인

2. **데이터베이스 파일 확인**
   ```bash
   # 파일이 존재하는지 확인
   ls -lh questions.db
   
   # 파일 크기가 0이 아닌지 확인
   # 파일 크기가 0이면 데이터가 저장되지 않은 것
   ```

3. **Streamlit Cloud인 경우**
   - Streamlit Cloud는 파일 시스템이 임시적일 수 있음
   - **해결책**: Google Sheets 연동 필수
   - 또는 Streamlit Cloud의 영구 스토리지 사용 (유료 플랜)

---

## 📊 테스트 시나리오 예시

### 시나리오 1: 기본 사용 흐름

1. 앱 실행
2. 익명으로 질문 3개 등록
3. 각 질문에 좋아요 추가
4. 검색으로 특정 질문 찾기
5. 정렬 변경해보기
6. 관리자 페이지에서 확인
7. 앱 재시작
8. 모든 질문이 유지되는지 확인

**예상 결과**: 모든 단계가 정상 작동하고 재시작 후에도 데이터 유지

### 시나리오 2: 에지 케이스 테스트

1. 매우 긴 질문 (1000자) 등록
2. 특수문자가 포함된 질문 등록
3. 같은 질문에 좋아요 여러 번 시도
4. 검색어로 찾을 수 없는 질문 검색
5. 관리자에서 질문 삭제

**예상 결과**: 모든 경우에 적절한 처리 (에러 메시지, 제한 등)

---

## 💡 테스트 팁

1. **브라우저 개발자 도구 사용**
   - F12로 개발자 도구 열기
   - Console 탭에서 JavaScript 에러 확인
   - Network 탭에서 API 호출 확인

2. **터미널 로그 확인**
   - Streamlit 실행 중 터미널에 에러 메시지가 표시됨
   - Python 에러는 여기서 확인 가능

3. **데이터베이스 직접 확인**
   ```bash
   sqlite3 questions.db
   .tables
   SELECT * FROM questions;
   ```

4. **여러 브라우저에서 테스트**
   - Chrome, Firefox, Safari 등에서 각각 테스트
   - 시크릿 모드에서도 테스트 (세션 격리)

---

## ✅ 최종 체크리스트

배포 전에 다음을 모두 확인하세요:

- [ ] 로컬에서 모든 기능 정상 작동
- [ ] 질문 등록/조회/삭제 정상 작동
- [ ] 검색 및 정렬 정상 작동
- [ ] 좋아요 기능 정상 작동
- [ ] 관리자 페이지 정상 작동
- [ ] 재시작 후 데이터 유지 확인
- [ ] SQLite 데이터베이스 생성 확인
- [ ] 에러 메시지가 적절히 표시됨
- [ ] 모바일 화면에서도 사용 가능 (반응형)
- [ ] GitHub에 푸시 완료
- [ ] Streamlit Cloud 배포 완료
- [ ] 배포 후 모든 기능 재테스트

---

**테스트 완료 후 배포하시면 안전하게 사용할 수 있습니다!** 🎉
